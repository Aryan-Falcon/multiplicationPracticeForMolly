<!DOCTYPE html> 
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Multiplication RPG ‚Äî Arcane Tower</title>

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: 'Georgia', serif;
        background: radial-gradient(circle at center, #3a0057, #120018);
        color: #f8e7ff;
        overflow-x: hidden;
    }

    h1 {
        text-align: center;
        font-size: 42px;
        margin-top: 20px;
        color: #ffd6ff;
        text-shadow: 0 0 15px #ff6cff;
    }

    /* === RANK PROGRESS BAR === */
    #rank-panel {
        position: fixed;
        top: 50px;
        left: 20px;
        height: 500px;
        width: 170px;
        display: flex;
        gap: 10px;
        z-index: 200;
    }

    #rank-bar-container {
        width: 25px;
        height: 500px;
        background: #2a0038;
        border: 2px solid #ff9dff;
        border-radius: 8px;
        overflow: hidden;
        position: relative;
    }

    #rank-fill {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 0%;
        background: linear-gradient(to top, #ff00ff, #ffb7ff);
        transition: height 0.4s ease-out;
    }

    #rank-labels {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 500px;
        font-size: 16px;
        padding-left: 5px;
    }

    .rank {
        opacity: 0.3;
        filter: brightness(0.5);
        transition: all 0.5s;
    }

    .rank.active {
        opacity: 1;
        filter: brightness(1.8);
        text-shadow: 0 0 10px #ff8dff;
    }

    /* Battlefield */
    #battlefield {
        margin-top: 40px;
        display: flex;
        justify-content: space-around;
        align-items: center;
    }

    .character {
        width: 200px;
        height: 200px;
        background-size: cover;
    }

    #hero {
        background-image: url('https://i.etsystatic.com/49218806/r/il/141e80/6557512067/il_fullxfull.6557512067_asdh.jpg');
    }

    #monster {
        background-image: url('https://p1.hiclipart.com/preview/549/267/644/monster-rpg-maker-mv-rpg-maker-vx-game-roleplaying-game-slime-slime-morimori-dragon-quest-video-game-development-png-clipart.jpg');
        transition: opacity 0.5s, transform 0.5s;
    }

    #hp-bars {
        text-align: center;
        margin-top: 20px;
        font-size: 24px;
    }

    .hp-bar {
        width: 60%;
        height: 25px;
        background: #3a003a;
        border: 2px solid #ffb7ff;
        margin: 10px auto;
    }

    .hp-fill {
        height: 100%;
        background: #ff55ff;
        width: 100%;
        transition: width 0.5s;
    }

    #question-box {
        margin-top: 30px;
        font-size: 32px;
        font-weight: bold;
        text-align: center;
    }

    input {
        margin-top: 15px;
        font-size: 26px;
        padding: 8px;
        width: 150px;
        text-align: center;
        border-radius: 10px;
        border: none;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    #log {
        font-size: 20px;
        margin-top: 20px;
        min-height: 60px;
        text-align: center;
    }

    #streak-indicator {
        font-size: 22px;
        margin-top: 10px;
        text-align: center;
        color: #ffd0ff;
        text-shadow: 0 0 10px #ff7cff;
    }

    #results {
        margin-top: 40px;
        font-size: 28px;
        font-weight: bold;
        text-align: center;
    }

    button {
        margin-top: 25px;
        padding: 12px 25px;
        background: #c200ff;
        border: none;
        border-radius: 10px;
        color: white;
        font-size: 26px;
        cursor: pointer;
    }

    button:hover { background: #ff2eff; }

    /* === PARTICLES === */
    .particle {
        position: absolute;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        pointer-events: none;
        opacity: 1;
        animation: particleFade 0.6s forwards;
    }

    @keyframes particleFade {
        to { transform: scale(0.1); opacity: 0; }
    }

    /* === SHOCKWAVE === */
    .impact {
        position: absolute;
        width: 140px;
        height: 140px;
        border-radius: 50%;
        background: radial-gradient(circle, white, transparent);
        animation: shockwave 0.4s forwards;
        pointer-events: none;
    }

    @keyframes shockwave {
        from { transform: scale(0.4); opacity: 1; }
        to { transform: scale(2); opacity: 0; }
    }
</style>
</head>

<body>

<h1>‚öîÔ∏è Multiplication RPG: Arcane Tower ‚öîÔ∏è</h1>

<!-- === SOUND EFFECTS === -->
<audio id="sfx-correct" src="https://assets.mixkit.co/sfx/preview/mixkit-magical-coin-win-1936.mp3"></audio>
<audio id="sfx-wrong" src="https://assets.mixkit.co/sfx/preview/mixkit-game-over-trombone-1940.mp3"></audio>
<audio id="sfx-hero-cast" src="https://assets.mixkit.co/sfx/preview/mixkit-arcane-magic-spell-3290.mp3"></audio>
<audio id="sfx-monster-cast" src="https://assets.mixkit.co/sfx/preview/mixkit-fast-woosh-1487.mp3"></audio>
<audio id="sfx-impact" src="https://assets.mixkit.co/sfx/preview/mixkit-quick-magical-sweep-1113.mp3"></audio>
<audio id="sfx-levelup" src="https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3"></audio>

<!-- === RANK BAR === -->
<div id="rank-panel">
    <div id="rank-bar-container">
        <div id="rank-fill"></div>
    </div>

    <div id="rank-labels">
        <div class="rank" id="rank6">Grandmaster ‚ú®</div>
        <div class="rank" id="rank5">Archmage üîÆ</div>
        <div class="rank" id="rank4">Mage ‚ö°</div>
        <div class="rank" id="rank3">Adept üìò</div>
        <div class="rank" id="rank2">Apprentice üåÄ</div>
        <div class="rank" id="rank1">Novice ‚öîÔ∏è</div>
    </div>
</div>

<div id="battlefield">
    <div id="hero" class="character"></div>
    <div id="monster" class="character"></div>
</div>

<div id="hp-bars">
    Hero HP
    <div class="hp-bar"><div id="hero-hp" class="hp-fill"></div></div>

    Monster HP
    <div class="hp-bar"><div id="monster-hp" class="hp-fill"></div></div>
</div>

<div id="streak-indicator">Streak: 0</div>

<div id="question-box"></div>

<input type="number" id="answer" placeholder="Press ENTER">

<div id="log"></div>

<div id="results"></div>

<script>
/* === SOUND FUNCTION === */
function playSound(id) {
    const s = document.getElementById(id);
    if (!s) return;
    s.currentTime = 0;
    s.play();
}

/* GAME VARIABLES */
let questions = [];
let current = 0;
let score = 0;
let streak = 0;
let monstersDefeated = 0;

let heroHP = 100;
let monsterHP = 60;

const ranks = ["Novice", "Apprentice", "Adept", "Mage", "Archmage", "Grandmaster"];

for (let i = 0; i < 30; i++) {
    let a = Math.ceil(Math.random() * 11);
    let b = Math.ceil(Math.random() * 11);
    questions.push({ a, b });
}

function updateRankBar() {
    let progress = (score / 30) * 100;
    document.getElementById("rank-fill").style.height = progress + "%";

    let level = 1;

    if (score === 30) level = 6;
    else if (score >= 25) level = 5;
    else if (score >= 20) level = 4;
    else if (score >= 15) level = 3;
    else if (score >= 10) level = 2;

    for (let i = 1; i <= 6; i++) {
        let label = document.getElementById("rank" + i);

        if (i <= level) {
            if (!label.classList.contains("active")) playSound("sfx-levelup");
            label.classList.add("active");
        } else {
            label.classList.remove("active");
        }
    }
}

/* === SPELL STYLE GENERATOR === */
function randomSpellStyle(isMonster) {
    const styles = ["arcane", "fire", "lightning", "chaos"];
    let type = styles[Math.floor(Math.random() * styles.length)];

    let spell = document.createElement("div");
    spell.style.position = "absolute";
    spell.style.width = "55px";
    spell.style.height = "55px";
    spell.style.borderRadius = "50%";
    spell.style.pointerEvents = "none";

    if (type === "arcane") {
        spell.style.background = "radial-gradient(circle, white, #ff99ff, #9900cc)";
        spell.style.boxShadow = "0 0 25px #ff66ff, 0 0 50px #cc00ff";
    }
    if (type === "fire") {
        spell.style.background = "radial-gradient(circle, white, #ff9900, #cc0000)";
        spell.style.boxShadow = "0 0 25px #ff3300, 0 0 70px #ff6600";
    }
    if (type === "lightning") {
        spell.style.background = "radial-gradient(circle, white, #99ccff, #0044ff)";
        spell.style.boxShadow = "0 0 25px #66aaff, 0 0 80px #0088ff";
    }
    if (type === "chaos") {
        spell.style.background = "radial-gradient(circle, white, #ff00ff, #00ffff, #ff3300)";
        spell.style.boxShadow = "0 0 50px #ff55ff, 0 0 80px #00ffff";
    }

    if (isMonster) {
        spell.style.background = "radial-gradient(circle, white, #66ccff, #0044ff)";
    }

    return spell;
}

function castSpell(fromId, toId, isMonster = false) {

    // üîä CAST SOUND
    if (isMonster) playSound("sfx-monster-cast");
    else playSound("sfx-hero-cast");

    let from = document.getElementById(fromId);
    let to = document.getElementById(toId);

    let rect1 = from.getBoundingClientRect();
    let rect2 = to.getBoundingClientRect();

    let spell = randomSpellStyle(isMonster);

    spell.style.left = rect1.left + rect1.width/2 - 25 + "px";
    spell.style.top = rect1.top + rect1.height/2 - 25 + "px";

    document.body.appendChild(spell);

    let particles = setInterval(() => {
        let p = document.createElement("div");
        p.className = "particle";
        p.style.left = spell.getBoundingClientRect().left + 20 + "px";
        p.style.top = spell.getBoundingClientRect().top + 20 + "px";
        p.style.background = spell.style.background;
        document.body.appendChild(p);
        setTimeout(() => p.remove(), 600);
    }, 40);

    let dx = rect2.left + rect2.width/2 - (rect1.left + rect1.width/2);
    let dy = rect2.top + rect2.height/2 - (rect1.top + rect1.height/2);

    spell.animate(
        [
            { transform: "translate(0,0)" },
            { transform: `translate(${dx}px, ${dy}px)` }
        ],
        { duration: 700, easing: "ease-out" }
    );

    setTimeout(() => {
        clearInterval(particles);
        spell.remove();

        // Impact
        let impact = document.createElement("div");
        impact.className = "impact";
        impact.style.left = rect2.left + rect2.width/2 - 70 + "px";
        impact.style.top = rect2.top + rect2.height/2 - 70 + "px";

        document.body.appendChild(impact);

        // üîä IMPACT SOUND
        playSound("sfx-impact");

        setTimeout(() => impact.remove(), 400);
    }, 700);
}

function showQuestion() {
    if (current >= 30 || heroHP <= 0) {
        endGame();
        return;
    }

    let q = questions[current];
    document.getElementById("question-box").innerHTML =
        `Question ${current + 1}/30:<br>${q.a} √ó ${q.b} = ?`;
}

function spawnMonster() {
    monsterHP = 60;
    document.getElementById("monster-hp").style.width = "100%";
    let mon = document.getElementById("monster");
    mon.style.opacity = 1;
    mon.style.transform = "scale(1)";
}

function submitAnswer() {
    let input = document.getElementById("answer");
    let userAnswer = Number(input.value);
    let q = questions[current];
    let correct = q.a * q.b;

    if (userAnswer === correct) {

        // üîä CORRECT SOUND
        playSound("sfx-correct");

        score++;
        streak++;

        updateRankBar();

        let dmg = 10 + streak * 5;
        if (dmg > 25) dmg = 25;
        monsterHP -= dmg;

        castSpell("hero", "monster");

        document.getElementById("log").innerHTML = `‚ú® Correct! You dealt <strong>${dmg}</strong> damage!`;

        if (monsterHP <= 0) {
            monstersDefeated++;
            document.getElementById("log").innerHTML += "<br>üí• Monster defeated!";
            setTimeout(spawnMonster, 700);
        }

    } else {

        // üîä WRONG SOUND
        playSound("sfx-wrong");

        streak = 0;
        heroHP -= 10;

        castSpell("monster", "hero", true);

        document.getElementById("log").innerHTML =
            `‚ùå Wrong! Correct answer: <strong>${correct}</strong>`;
    }

    document.getElementById("hero-hp").style.width = heroHP + "%";
    document.getElementById("monster-hp").style.width = monsterHP + "%";

    document.getElementById("streak-indicator").innerHTML = `Streak: ${streak}`;

    input.value = "";
    current++;
    showQuestion();
}

document.getElementById("answer").addEventListener("keydown", e => {
    if (e.key === "Enter") submitAnswer();
});

function endGame() {
    let finalRank = "";

    if (score === 30) finalRank = "Grandmaster";
    else if (score >= 25) finalRank = "Archmage";
    else if (score >= 20) finalRank = "Mage";
    else if (score >= 15) finalRank = "Adept";
    else if (score >= 10) finalRank = "Apprentice";
    else finalRank = "Novice";

    document.getElementById("results").innerHTML = `
        <p>You defeated <strong>${monstersDefeated}</strong> monsters!</p>
        <p>Your Score: <strong>${score}/30</strong></p>
        <p>Your Final Rank: <strong>${finalRank}</strong> üèÜ</p>
        <button onclick="location.reload()">Play Again</button>
    `;
}

showQuestion();
updateRankBar();
</script>

</body>
</html>
