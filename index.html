<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Multiplication RPG — Arcane Tower</title>

<style>
body {
    margin: 0;
    font-family: 'Georgia', serif;
    background: radial-gradient(circle at center, #3a0057, #120018);
    color: #f8e7ff;
}

h1 {
    text-align: center;
    font-size: 42px;
    margin-top: 20px;
    text-shadow: 0 0 15px #ff6cff;
}

/* ===== RANK BAR ===== */
#rank-panel {
    position: fixed;
    top: 100px;
    left: 20px;
    display: flex;
    gap: 10px;
}

#rank-bar {
    position: relative;
    width: 25px;
    height: 300px;
    background: #2a0038;
    border: 2px solid #ff9dff;
    border-radius: 8px;
    overflow: hidden;
}

#rank-fill {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 0%;
    background: linear-gradient(to top, #ff00ff, #ffb7ff);
    transition: height 0.4s ease-out;
}

#rank-labels {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 300px;
}

.rank { opacity: 0.3; }
.rank.active {
    opacity: 1;
    text-shadow: 0 0 10px #ff9dff;
}

/* ===== BATTLEFIELD ===== */
#battlefield {
    margin-top: 40px;
    display: flex;
    justify-content: space-around;
    align-items: center;
}

.character {
    width: 230px;
    height: 230px;
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
}

#hero {
    background-image: url("https://i.etsystatic.com/49218806/r/il/141e80/6557512067/il_fullxfull.6557512067_asdh.jpg");
}

.hp-bar {
    width: 60%;
    height: 22px;
    background: #3a003a;
    border: 2px solid #ffb7ff;
    margin: 10px auto;
}

.hp-fill {
    height: 100%;
    background: #ff55ff;
    width: 100%;
    transition: width 0.5s;
}

#timer {
    text-align: center;
    font-size: 30px;
    margin-top: 10px;
}

#question-box {
    font-size: 32px;
    text-align: center;
    margin-top: 20px;
}

input {
    font-size: 26px;
    padding: 8px;
    width: 150px;
    display: block;
    margin: 15px auto;
    border-radius: 10px;
    border: none;
}

#feedback {
    font-size: 36px;
    text-align: center;
    padding: 18px;
    margin-top: 15px;
    display: none;
    border-radius: 15px;
}

.correct {
    background: rgba(0,255,150,0.15);
    border: 3px solid #00ff99;
}

.wrong {
    background: rgba(255,0,80,0.15);
    border: 3px solid #ff3366;
}
</style>
</head>

<body>

<h1>⚔️ Multiplication RPG: Arcane Tower ⚔️</h1>

<div id="rank-panel">
    <div id="rank-bar"><div id="rank-fill"></div></div>
    <div id="rank-labels">
        <div class="rank" id="r6">Grandmaster</div>
        <div class="rank" id="r5">Archmage</div>
        <div class="rank" id="r4">Mage</div>
        <div class="rank" id="r3">Adept</div>
        <div class="rank" id="r2">Apprentice</div>
        <div class="rank" id="r1">Novice</div>
    </div>
</div>

<div id="battlefield">
    <div id="hero" class="character"></div>
    <div id="monster" class="character"></div>
</div>

<div style="text-align:center">
    Hero HP
    <div class="hp-bar"><div id="hero-hp" class="hp-fill"></div></div>
    Monster HP
    <div class="hp-bar"><div id="monster-hp" class="hp-fill"></div></div>
</div>

<div id="timer">⏳ Time: 16</div>
<div id="question-box"></div>
<input id="answer" type="number" placeholder="ENTER">
<div id="feedback"></div>

<script>
let questions = [], current = 0, score = 0, streak = 0, monstersDefeated = 0;
let heroHP = 100, monsterHP = 60;
const FIXED_TIME = 16;
const WRONG_DELAY = 4000;
let timeLeft, timer;

const monsterImages = {
1:"https://p1.hiclipart.com/preview/549/267/644/monster-rpg-maker-mv-rpg-maker-vx-game-roleplaying-game-slime-slime-morimori-dragon-quest-video-game-development-png-clipart.jpg",
2:"https://i.pinimg.com/originals/12/74/5e/12745ef0d668ea915bc5cb4a6223e643.jpg",
3:"https://i.pinimg.com/564x/bc/92/9a/bc929acfd5d867c805c06dbe8b05855c.jpg",
4:"https://koboldpress.com/wp-content/uploads/2013/02/ghost_goblin_by_chrismcfann.jpg",
5:"https://i.pinimg.com/474x/c8/51/9c/c8519ce4a412892d327c7671c1f30bc3.jpg",
6:"https://static.wikia.nocookie.net/rpgtalk/images/e/e0/IronGolemDNDB.jpeg",
7:"https://i.pinimg.com/474x/76/47/77/7647777b090a764468351b91061db6f4.jpg",
8:"https://img.freepik.com/free-photo/literary-fantasy-character_23-2151863447.jpg",
9:"https://i.pinimg.com/474x/c8/51/9c/c8519ce4a412892d327c7671c1f30bc3.jpg",
10:"https://img.freepik.com/premium-photo/close-up-monster-with-purple-face-purple-body-generative-ai_974533-21727.jpg"
};

/* Generate questions */
for (let i = 0; i < 30; i++) {
    questions.push({
        a: Math.ceil(Math.random() * 12),
        b: Math.ceil(Math.random() * 12)
    });
}

/* Rank update */
function updateRank() {
    let accuracy = current === 0 ? 0 : score / current;
    if (accuracy > 1) accuracy = 1;

    document.getElementById("rank-fill").style.height = (accuracy * 100) + "%";

    let level =
        accuracy >= 0.999 ? 6 :
        accuracy >= 0.83  ? 5 :
        accuracy >= 0.66  ? 4 :
        accuracy >= 0.5   ? 3 :
        accuracy >= 0.33  ? 2 : 1;

    for (let i = 1; i <= 6; i++) {
        document.getElementById("r" + i)
            .classList.toggle("active", i <= level);
    }
}

/* Timer */
function startTimer() {
    clearInterval(timer);
    timeLeft = FIXED_TIME;
    document.getElementById("timer").innerText = `⏳ Time: ${timeLeft}`;
    timer = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").innerText = `⏳ Time: ${timeLeft}`;
        if (timeLeft <= 0) {
            clearInterval(timer);
            monsterAttack("⏰ Time's up!");
        }
    }, 1000);
}

/* Advance question safely */
function advanceQuestion() {
    current++;
    updateRank();
    showQuestion();
    startTimer();
}

/* Game flow */
function spawnMonster() {
    monsterHP = 60;
    document.getElementById("monster-hp").style.width = "100%";
    document.getElementById("monster").style.backgroundImage =
        `url('${monsterImages[monstersDefeated + 1] || monsterImages[1]}')`;
}

function showQuestion() {
    if (monstersDefeated >= 10 || heroHP <= 0) return endGame();
    let q = questions[current];
    document.getElementById("question-box").innerText = `${q.a} × ${q.b} = ?`;
}

function showFeedback(text, type) {
    let f = document.getElementById("feedback");
    f.className = type;
    f.innerHTML = text;
    f.style.display = "block";
}

function monsterAttack(reason) {
    streak = 0;
    heroHP -= 10 + monstersDefeated * 5;
    let q = questions[current];
    showFeedback(`${reason}<br>${q.a} × ${q.b} = ${q.a * q.b}`, "wrong");
    document.getElementById("hero-hp").style.width = heroHP + "%";

    setTimeout(() => {
        document.getElementById("feedback").style.display = "none";
        advanceQuestion();
    }, WRONG_DELAY);
}

function submitAnswer() {
    clearInterval(timer);
    let q = questions[current];
    let correct = q.a * q.b;

    if (Number(answer.value) === correct) {
        streak++;
        score++;
        updateRank();

        let dmg = Math.min(10 + streak * 4, 35);
        monsterHP -= dmg;
        showFeedback(`✅ Correct!<br>Damage: ${dmg}`, "correct");

        setTimeout(() => {
            document.getElementById("feedback").style.display = "none";

            if (monsterHP <= 0) {
                monstersDefeated++;
                if (monstersDefeated >= 10) return endGame();
                spawnMonster();
            }

            document.getElementById("monster-hp").style.width = monsterHP + "%";
            advanceQuestion();
        }, 1200);

    } else {
        monsterAttack("❌ Wrong!");
    }

    answer.value = "";
}

function endGame() {
    let accuracy = current === 0 ? 0 : score / current;
    if (accuracy > 1) accuracy = 1;

    let finalRank =
        accuracy >= 0.999 ? "Grandmaster" :
        accuracy >= 0.83  ? "Archmage" :
        accuracy >= 0.66  ? "Mage" :
        accuracy >= 0.5   ? "Adept" :
        accuracy >= 0.33  ? "Apprentice" :
        "Novice";

    document.body.innerHTML = `
        <h1>Game Over</h1>
        <p style="text-align:center">Monsters defeated: ${monstersDefeated}</p>
        <p style="text-align:center">Correct Answers: ${score} / ${current}</p>
        <p style="text-align:center">Final Rank: ${finalRank}</p>
        <button onclick="location.reload()">Play Again</button>
    `;
}

answer.addEventListener("keydown", e => {
    if (e.key === "Enter") submitAnswer();
});

/* Start game */
spawnMonster();
showQuestion();
startTimer();
document.getElementById("hero-hp").style.width = "100%";
</script>

</body>
</html>
